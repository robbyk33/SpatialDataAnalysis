<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hw05 - Regional Count Data Homework (Local Rates)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="rc-hw-local-rates_files/libs/clipboard/clipboard.min.js"></script>
<script src="rc-hw-local-rates_files/libs/quarto-html/quarto.js"></script>
<script src="rc-hw-local-rates_files/libs/quarto-html/popper.min.js"></script>
<script src="rc-hw-local-rates_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="rc-hw-local-rates_files/libs/quarto-html/anchor.min.js"></script>
<link href="rc-hw-local-rates_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="rc-hw-local-rates_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="rc-hw-local-rates_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="rc-hw-local-rates_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="rc-hw-local-rates_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hw05 - Regional Count Data Homework (Local Rates)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The <code>nc.rda</code> file contains information related to SIDS cases in North Carolina. The object includes <code>nc.sids</code>, a spatial data frame compatible with the <strong>sf</strong> package with 20 variables measured for 100 counties. It contains data given in Cressie (1991, pp.&nbsp;386-9), Cressie and Read (1985), and Cressie and Chan (1989) on sudden infant deaths in North Carolina for 1974-78 and 1979-84. The <code>nc.rda</code> objects also contains the neighbor list given by Cressie and Chan (1989) omitting self-neighbors (nb89), and the neighbor list given by Cressie and Read (1985) for contiguities (nb85). The <code>nc.sids</code> object contains the following variables:</p>
<ul>
<li><code>SP_ID</code>: SpatialPolygons ID</li>
<li><code>CNTY_ID</code>: county ID</li>
<li><code>east</code>: eastings, county seat, miles, local projection</li>
<li><code>north</code>: northings, county seat, miles, local projection</li>
<li><code>L_id</code>: Cressie and Read (1985) L index</li>
<li><code>M_id</code>: Cressie and Read (1985) M index</li>
<li><code>names</code>: County names</li>
<li><code>AREA</code>: County polygon areas in degree units</li>
<li><code>PERIMETER</code>: County polygon perimeters in degree units</li>
<li><code>CNTY_</code> Internal county ID</li>
<li><code>NAME</code>: County names</li>
<li><code>FIPS</code>: County ID</li>
<li><code>FIPSNO</code>: County ID</li>
<li><code>CRESS_ID</code>: Cressie papers ID</li>
<li><code>BIR74</code>: births, 1974-78</li>
<li><code>SID74</code>: SID deaths, 1974-78</li>
<li><code>NWBIR74</code>: non-white births, 1974-78</li>
<li><code>BIR79</code>: births, 1979-84</li>
<li><code>SID79</code>: SID deaths, 1979-84</li>
<li><code>NWBIR79</code>: non-white births, 1979-84</li>
</ul>
<section id="problem-1" class="level1">
<h1>Problem 1</h1>
<p>Construct plots of the two neighbor relationships (<code>nb85</code> and <code>nb89</code>) centered at the approximate centroids of each county (i.e., use the <code>st_centroids</code> function to get the approximate centroid of each county for plotting purposes). What differences do you notice in the two plots?</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To access larger datasets in this package, install the spDataLarge
package with: `install.packages('spDataLarge',
repos='https://nowosad.github.io/drat/', type='source')`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.6.2, PROJ 9.2.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smerc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code># This research was partially supported under NSF grants 1463642 and 1915277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">"nc.rda"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot region boundaries from nc.sids</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids<span class="sc">$</span>geometry))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot neighbors nb85</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb85, <span class="at">coords =</span> <span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(nc.sids<span class="sc">$</span>geometry)),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot region boundaries from nc.sids</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids<span class="sc">$</span>geometry))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot neighbors nb89</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nb89, <span class="at">coords =</span> <span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(nc.sids<span class="sc">$</span>geometry)),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>The first plot for the nb85 neighbors appears to have more connections all across the study area with fewer patterns of clustering while the nb89 area has more white space (less connections ar a higher spatial scale) and appears to have some evidence of clustering in the northeast region of our study area.</p>
</blockquote>
</section>
<section id="problem-2" class="level1">
<h1>Problem 2</h1>
<section id="a" class="level2">
<h2 class="anchored" data-anchor-id="a">(a)</h2>
<p>Create choropleth maps (a plot that colors each region with a value indicating the response level) of the <code>SID74</code> and <code>SID79</code> variables.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nc.sids[<span class="st">"SID74"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nc.sids[<span class="st">"SID79"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">(b)</h2>
<p>Where do the SIDS deaths tend to be highest? Is there a lot of discrepancy between the plots of the two data sets, or is the overall pattern similar?</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>In general, it appears the intensity of SIDs deaths located in the center bottom region, with a slight translation of SIDs deaths from right to left between the SID74 to the SID79 plot.</p>
</blockquote>
</section>
<section id="c" class="level2">
<h2 class="anchored" data-anchor-id="c">(c)</h2>
<p>Why must we be cautious in concluding the brighter regions are most likely to be hotspots/clusters of cases? What might be a better way of displaying the data?</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>The brighter regions may have more total number of cases but also have a much higher population or number of births. A better way to display the data would be to show the intensity in that county relative to the county’s total population or total birth count.</p>
</blockquote>
</section>
</section>
<section id="problem-3" class="level1">
<h1>Problem 3</h1>
<p>Use the CEPP method to identify potential clusters for the <code>SID74</code> variable. Note that the “population” associated with each region should be the associated number of births during the respective time period, provided in <code>BIR74</code>. Use a significance level of 0.01 and <span class="math inline">\(n^*=\)</span> 2000, 20000, and 100000. Use <code>east</code> and <code>north</code> (the x and y coordinates) to define the centroid associated with each region. Do not use the centroids you obtained from the <code>st_centroids</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nc.sids<span class="sc">$</span>east,nc.sids<span class="sc">$</span>north)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">=</span> nc.sids<span class="sc">$</span>SID79</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">=</span> nc.sids<span class="sc">$</span>BIR74</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential clusters at n* = 2000</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>cepp2k <span class="ot">=</span> <span class="fu">cepp.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cases =</span> cases,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">pop =</span> pop,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nstar =</span> <span class="dv">2000</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sig_noc_mod(tobs = cstar, zones = nn, pvalue = pvalue, alpha =
alpha, : No significant clusters.  Returning most likely cluster.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of significant clusters</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cepp2k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist    cases  ex  rr stat     p
1        1        0 14.19069 5.1 2.8 14.2 0.016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential clusters at n* = 20000</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cepp20k <span class="ot">=</span> <span class="fu">cepp.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cases =</span> cases,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">pop =</span> pop,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nstar =</span> <span class="dv">20000</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">alpha =</span> <span class="fl">0.01</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of significant clusters</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cepp20k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist    cases   ex  rr stat     p
1        6     50.6 79.04007 50.7 1.6   79 0.006</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential clusters at n* = 100,000</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cepp100k <span class="ot">=</span> <span class="fu">cepp.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cases =</span> cases,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">pop =</span> pop,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nstar =</span> <span class="dv">100000</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sig_noc_mod(tobs = cstar, zones = nn, pvalue = pvalue, alpha =
alpha, : No significant clusters.  Returning most likely cluster.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of significant clusters</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cepp100k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist    cases    ex  rr  stat     p
1       22    129.4 295.3834 253.4 1.3 295.4 0.032</code></pre>
</div>
</div>
<section id="a-1" class="level2">
<h2 class="anchored" data-anchor-id="a-1">(a)</h2>
<p>State the null and alternative hypothesis test in the context of the problem for a generic <span class="math inline">\(n^*\)</span>.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>Null: There is no window with n* persons at risk that has significantly more cases than what would be expected under CRH.</p>
<p>Alternative: There is at least one window with n* persons at risk that has significantly more cases than would be expected under CRH.</p>
</blockquote>
</section>
<section id="b-1" class="level2">
<h2 class="anchored" data-anchor-id="b-1">(b)</h2>
<p>Interpret the overall results in the context of the problem.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>We see evidence of clustering of intensity of cases relative to what would be expected under CRH for n* = 2,000 and n* = 20,000 at the alpha = 0.01 level. Specifically, we can conclude that the intensity in the identified regions is not consistent with the constant risk hypothesis at the n* = 2,000 persons at risk and n* = 20,000 persons at risk.</p>
</blockquote>
</section>
<section id="c-1" class="level2">
<h2 class="anchored" data-anchor-id="c-1">(c)</h2>
<p>Plot the results on the map of North Carolina counties. Don’t worry too much about clearly identifying the clusters (cluster A, B, C, etc.). Look at the overarching patterns of the plots. Are the clusters in roughly the same areas? Are the clusters roughly the same size (in terms of number of regions?) Explain.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of most likely clusters for n* = 2000</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids), <span class="at">border =</span> <span class="st">"grey60"</span>, <span class="at">axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">color.clusters</span>(cepp2k))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n* = 2000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of most likely clusters for n* = 20000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids), <span class="at">border =</span> <span class="st">"grey60"</span>, <span class="at">axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">color.clusters</span>(cepp20k))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n* = 20,000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of most likely clusters for n* = 100,000</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids), <span class="at">border =</span> <span class="st">"grey60"</span>, <span class="at">axes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">color.clusters</span>(cepp100k))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"n* = 100,000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>The clusters appear to be in the same relative region (lower central region) however the number of regions for each plot more than doubles from the previous - this makes sense because as we increase the threshold for n* (number of persons at risk identified in the window) the more regions will be in the window with that many persons at risk.</p>
</blockquote>
</section>
</section>
<section id="problem-4" class="level1">
<h1>Problem 4</h1>
<p>Use the Besag-Newell method to identify potential clusters for the <code>SID74</code> variable. Note that the “population” associated with each region should be the associated number of births during the respective time period, provided in <code>BIR74</code>. Use a significance level of 0.01 and <span class="math inline">\(c^*=\)</span> 6, 12, and 25. Use <code>east</code> and <code>north</code> (the x and y coordinates) to define the centroid associated with each region. Do not use the centroids you obtained from the <code>st_centroids</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nc.sids<span class="sc">$</span>east,nc.sids<span class="sc">$</span>north)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">=</span> nc.sids<span class="sc">$</span>SID79</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">=</span> nc.sids<span class="sc">$</span>BIR74</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>bn6 <span class="ot">=</span> <span class="fu">bn.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">cases =</span> cases,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">pop =</span> pop,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">cstar =</span> <span class="dv">6</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sig_noc(tobs = l, zones = cwins, pvalue = pvalue, alpha = alpha, :
No significant clusters.  Returning most likely cluster.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bn6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist cases  ex  rr stat         p
1        1        0     8 3.2 2.5    1 0.1039658</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span>(bn6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bn12 <span class="ot">=</span> <span class="fu">bn.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">cases =</span> cases,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">pop =</span> pop,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">cstar =</span> <span class="dv">12</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sig_noc(tobs = l, zones = cwins, pvalue = pvalue, alpha = alpha, :
No significant clusters.  Returning most likely cluster.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bn12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist cases  ex  rr stat          p
1        1        0    16 5.7 2.8    1 0.01437007</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span>(bn12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bn25 <span class="ot">=</span> <span class="fu">bn.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">cases =</span> cases,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">pop =</span> pop,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">cstar =</span> <span class="dv">25</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sig_noc(tobs = l, zones = cwins, pvalue = pvalue, alpha = alpha, :
No significant clusters.  Returning most likely cluster.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bn25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist cases   ex  rr stat          p
1        3     35.4    25 16.4 1.5    3 0.02901974</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span>(bn25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 66 42 46</code></pre>
</div>
</div>
<section id="a-2" class="level2">
<h2 class="anchored" data-anchor-id="a-2">(a)</h2>
<p>State the null and alternative hypothesis test in the context of the problem for a generic <span class="math inline">\(c^*\)</span>.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>Null: The most compact window (population wise) with at least c* cases is not significantly more compact than what is expected under the CRH.</p>
<p>Alternative: The most compact window (in terms of population size) with at least c* cases is significantly more compact than what is expected under the CRH.</p>
</blockquote>
</section>
<section id="b-2" class="level2">
<h2 class="anchored" data-anchor-id="b-2">(b)</h2>
<p>Interpret the overall results in the context of the problem.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>Based on the besag-newell test, we do not find evidence that the most compact window with c* cases is more compact than it would be under CRH for any value of c*. In other words, we do not find evidence of clustering of SIDs deaths more than would be expected under CRH.</p>
</blockquote>
</section>
<section id="c-2" class="level2">
<h2 class="anchored" data-anchor-id="c-2">(c)</h2>
<p>Plot the results on the map of North Carolina counties. Don’t worry too much about clearly identifying the clusters (cluster A, B, C, etc.). Look at the overarching patterns of the plots. Are the clusters in roughly the same areas? Are the clusters roughly the same size (in terms of number of regions?) Explain.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">colorblindFriendly =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mycol <span class="ot">=</span> <span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">"Dark2"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of colors to show results</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># default is white (no clustering)</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>nccol <span class="ot">=</span> <span class="fu">rep</span>(<span class="st">"white"</span>, <span class="fu">nrow</span>(nc.sids))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the most likely cluster locations for cstar = 6 are green</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>nccol[bn6<span class="sc">$</span>clusters[[<span class="dv">1</span>]]<span class="sc">$</span>locids] <span class="ot">=</span> mycol[<span class="dv">1</span>]</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># the most likely cluster locations for cstar = 12 are orange</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>nccol[bn12<span class="sc">$</span>clusters[[<span class="dv">1</span>]]<span class="sc">$</span>locids] <span class="ot">=</span> mycol[<span class="dv">2</span>]</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the most likely cluster locations for cstar = 25 are violet</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>nccol[bn25<span class="sc">$</span>clusters[[<span class="dv">1</span>]]<span class="sc">$</span>locids] <span class="ot">=</span> mycol[<span class="dv">3</span>]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot most likely clusters</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(nc.sids), <span class="at">border=</span><span class="st">"grey60"</span>, <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> nccol)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Cluster k = 6 (Green)"</span>, <span class="st">"Cluster k = 12 (Orange)"</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Cluster k = 25 (Violet)"</span>),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">10</span>, <span class="at">col =</span> nccol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>The clusters for k=6 and k=12 are the same size, the cluster for k=25 has an additional 2 regions. The first two clusters are in the same lower central area of the study area while the k=25 cluster is in the top right corner of the study area.</p>
</blockquote>
</section>
</section>
<section id="problem-5" class="level1">
<h1>Problem 5</h1>
<p>Use the Poisson spatial scan statistic method under the CRH to identify potential clusters for the <code>SID74</code> variable. Note that the “population” associated with each region should be the associated number of births during the respective time period, provided in <code>BIR74</code>, respectively. Use a significance level of 0.10. Use two different population upper bounds: 0.1 and 0.5. Use <code>east</code> and <code>north</code> (the x and y coordinates) to define the centroid associated with each region. Do not use the centroids you obtained from the <code>st_centroids</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nc.sids<span class="sc">$</span>east,nc.sids<span class="sc">$</span>north)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">=</span> nc.sids<span class="sc">$</span>SID79</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">=</span> nc.sids<span class="sc">$</span>BIR74</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expected number of cases</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">sum</span>(cases)<span class="sc">/</span><span class="fu">sum</span>(pop) <span class="sc">*</span> pop</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply circular scan method</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>scan <span class="ot">=</span> <span class="fu">scan.test</span>(<span class="at">coords =</span> coords,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cases =</span> cases,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pop =</span> pop,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ex =</span> e,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nsim =</span> <span class="dv">999</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha  =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>computing statistics for simulated data:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># results from the test are available in</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(scan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  nregions max_dist cases   ex  rr stat     p
1        5     49.9    70 42.5 1.7  7.9 0.027</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster information</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clusters</span>(scan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 78  9 24 47 83</code></pre>
</div>
</div>
<section id="a-3" class="level2">
<h2 class="anchored" data-anchor-id="a-3">(a)</h2>
<p>State the null and alternative hypotheses in the context of the problem.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>Null: The most likely cluster of cases (local rate in cluster relative to outside of cluster) is consistent with what is expected under the CRH.</p>
<p>Alternative: The most likely cluster (in terms of local rate of cases vs the rate outside of the cluster) is more extreme than what is expected under CRH.</p>
</blockquote>
</section>
<section id="b-3" class="level2">
<h2 class="anchored" data-anchor-id="b-3">(b)</h2>
<p>Interpret the overall results in the context of the problem.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>At the alpha = 0.1 level, we can reject the null hypothesis and conclude that there is evidence that the most likely cluster identified is more extreme in intensity of cases within the cluster relative to intensity of cases outside of the cluster than what would be expected under CRH.</p>
</blockquote>
</section>
<section id="c-3" class="level2">
<h2 class="anchored" data-anchor-id="c-3">(c)</h2>
<p>Plot the results on the map of North Carolina counties. Don’t worry too much about clearly identifying the clusters (cluster A, B, C, etc.). Look at the overarching patterns of the plots. Are the clusters in roughly the same areas? Are the clusters roughly the same size (in terms of number of regions?) Explain.</p>
<p><strong>Solution</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need to color 1 clusters</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>mycol <span class="ot">=</span> grDevices<span class="sc">::</span><span class="fu">hcl.colors</span>(<span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sf<span class="sc">::</span><span class="fu">st_geometry</span>(nc.sids), <span class="at">border=</span><span class="st">"grey60"</span>, <span class="at">axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">color.clusters</span>(scan, <span class="at">col =</span> mycol))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Cluster A"</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">10</span>, <span class="at">col =</span> mycol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="rc-hw-local-rates_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>The scan statistic only returned a single cluster. The location of this cluster is similarly in the lower central region, as most clusters we plotted with previous methods were.</p>
</blockquote>
</section>
</section>
<section id="problem-6" class="level1">
<h1>Problem 6</h1>
<p>How do the plots for the CEPP, Besag-Newell, and scan methods compare to one another? Do you believe there is a cluster (or clusters) of SIDS cases present in the data? Explain.</p>
<p><strong>Solution</strong></p>
<blockquote class="blockquote">
<p>Most of the statistically significant evidence of clustering identified the clusters in the same general region - somewhere in the lower central area of our study area. This leads me to believe that there is significant evidence of clusters of SIDs cases, or at least of one cluster, and the location of that cluster is likely in the lower central region of our study area.</p>
</blockquote>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>